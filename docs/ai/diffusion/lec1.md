# Flow and Diffusion Models

## æµæ¨¡å‹ Flow Models

### å®šä¹‰ ODE

é¦–å…ˆï¼Œæˆ‘ä»¬ä»å®šä¹‰ ODE (ordinary differential equations) å¼€å§‹ã€‚ODE çš„ä¸€ä¸ªè§£è¢«å®šä¹‰ä¸º **è½¨è¿¹** (trajectory)ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å½¢å¼ï¼š


$$
X:[0,1]\to\mathbb{R}^d,\quad t\mapsto X_t
$$


å®ƒè¡¨ç¤ºäº†ä»æ—¶é—´ $t$ åˆ°ç©ºé—´ $\mathbb{R}^d$ ä¸­æŸä¸€ä½ç½®çš„æ˜ å°„ã€‚

!!! info "è½¨è¿¹ (trajectory)"

    å¯ä»¥æŠŠè½¨è¿¹ç†è§£ä¸ºç‰©ä½“éšæ—¶é—´å˜åŒ–çš„è·¯å¾„ã€‚æƒ³è±¡ä¸€ä¸ªåœ¨ç©ºé—´ä¸­è¿åŠ¨çš„å°çƒï¼Œ$X_t$ æè¿°äº†å°çƒåœ¨ $t$ æ—¶åˆ»æ‰€å¤„çš„ä½ç½®ã€‚è€Œåœ¨ç”Ÿæˆæ¨¡å‹çš„èƒŒæ™¯ä¸‹ï¼Œè¿™ä¸ªâ€œç©ºé—´â€æ˜¯ä¸€ä¸ªéå¸¸é«˜ç»´åº¦çš„ç©ºé—´ï¼ˆä¾‹å¦‚ï¼Œä¸€å¼ å›¾ç‰‡çš„æ‰€æœ‰åƒç´ å€¼æ„æˆçš„ç©ºé—´ï¼‰ï¼Œè€Œâ€œç‚¹â€å°±æ˜¯æˆ‘ä»¬è¦ç”Ÿæˆçš„å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œä¸€å¼ å›¾ç‰‡ï¼‰ ã€‚

æ¯ä¸ª ODE éƒ½è¢«ä¸€ä¸ªå‘é‡åœº $u$ (vector field) å®šä¹‰ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å½¢å¼ï¼š


$$
u:\mathbb{R}^d\times[0,1]\to\mathbb{R}^d,\quad(x,t)\mapsto u_t(x)
$$


å³å¯¹äºä»»æ„æ—¶é—´ $t$ å’Œä»»æ„ä½ç½® $x$ï¼Œæˆ‘ä»¬éƒ½èƒ½å–å¾—ä¸€ä¸ªå‘é‡ $u_t(x)\in\mathbb{R}^d$ï¼Œå®ƒè¡¨ç¤ºäº†ç©ºé—´ä¸­çš„ä¸€ä¸ªé€Ÿåº¦ã€‚

!!! info "å‘é‡åœº (vector field)"

    å¯ä»¥é€šè¿‡åˆ†åˆ«å›ºå®š $t$ å’Œ $x$ çš„æ–¹å¼æ¥ç†è§£ï¼š

    - **å›ºå®š $t$**ï¼šå¾—åˆ°ä¸€ä¸ªåœ¨ $\mathbb{R}^d$ ä¸Šçš„å‘é‡åœºã€‚
    - **å›ºå®š $x$**ï¼šçœ‹åˆ°è¿™ä¸ªç‚¹éšæ—¶é—´ $t$ çš„æ¼”åŒ–é€Ÿåº¦å¦‚ä½•å˜åŒ–ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª ODE æ–¹ç¨‹æ¥çº¦æŸä¸€æ¡è½¨è¿¹ï¼š


$$
\begin{align*}
\frac{d}{dt} X_t &= u_t(X_t) \quad &&\blacktriangleright \text{ODE} \\
X_0 &= x_0 \quad &&\blacktriangleright \text{initial conditions}
\end{align*}
$$


å®ƒæè¿°äº†ç²’å­çš„ä½ç½® $X_t$ ä¼šæ²¿ç€æ—¶é—´å˜åŒ–çš„å‘é‡åœº $u_t$ è¿›è¡ŒæµåŠ¨ã€‚å…·ä½“åœ°ï¼š

- åœ¨æ¯ä¸€ä¸ªæ—¶åˆ» $t$ï¼Œç³»ç»Ÿéƒ½æœ‰ä¸€ä¸ªâ€œé€Ÿåº¦åœºâ€ $u_t(x)$ï¼›
- ç»™å®šå½“å‰ç²’å­ä½ç½® $X_t$ï¼Œç”¨å‘é‡åœº $u_t(X_t)$ è®¡ç®—å…¶å¯¼æ•°ï¼ˆé€Ÿåº¦ï¼‰ï¼›
- è¿™ä¸ªé€Ÿåº¦å‘Šè¯‰æˆ‘ä»¬ä¸‹ä¸€åˆ» $X_t$ ä¼šå¾€å“ªé‡Œèµ°ï¼›
- æŠŠæ‰€æœ‰ $t \in [0,1]$ ç»„åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€æ¡è½¨è¿¹ $X_t$ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯èƒ½æå‡ºè¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬åœ¨ $t=0$ æ—¶åˆ»ä» $X_0=x_0$ å‡ºå‘ï¼Œé‚£ä¹ˆ $t$ æ—¶åˆ»æˆ‘ä»¬åœ¨å“ªï¼ˆå³æ±‚ $X_t$ çš„å€¼ï¼‰ã€‚è€Œè¿™ä¸ªé—®é¢˜å¯ä»¥ç”¨å¦‚ä¸‹çš„**æµ (flow)** æ¥æè¿°ï¼Œå®ƒæ˜¯ ODE æ–¹ç¨‹çš„ä¸€ä¸ªè§£ï¼š


$$
\begin{align*}
\psi : \mathbb{R}^d \times [0,1] &\mapsto \mathbb{R}^d, \quad (x_0, t) \mapsto \psi_t(x_0) \\
\frac{d}{dt} \psi_t(x_0) &= u_t(\psi_t(x_0)) \quad &&\blacktriangleright \text{flow ODE} \\
\psi_0(x_0) &= x_0 \quad &&\blacktriangleright \text{flow initial conditions}
\end{align*}
$$


![flow-example](img/image-20250722195754923.webp)

å½“ç»™å®š $X_0=x_0$ï¼ŒODE çš„ä¸€æ¡è½¨è¿¹å¯ä»¥ç”± $X_t=\psi_t(X_0)$ å¾—åˆ°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å®¹æ˜“å‘ç°å‘é‡åœºã€å¸¸å¾®åˆ†æ–¹ç¨‹ã€æµä¹‹é—´çš„å…³ç³»ï¼š

> vector fields define ODEs whose solutions are flows.

å¦å¤–ï¼Œä¸ºäº†æ•°å­¦ä¸Šçš„ä¸¥è°¨æ€§ï¼Œæœ‰å®šç†è¯æ˜ï¼š**æ¯ä¸€ä¸ª ODE éƒ½æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª flow ä¸ä¹‹å¯¹åº”**ã€‚ç”±äºæˆ‘ä»¬åœ¨å®é™…åº”ç”¨ä¸­é€šå¸¸æŠŠå®ƒå½“ä½œå·²çŸ¥ç»“è®ºï¼Œåœ¨æ­¤ç•¥å»ä¸è¡¨ã€‚

??? note "çº¿æ€§å‘é‡åœºçš„ä¸€ä¸ªğŸŒ°"

    è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç®€å•çš„å‘é‡åœº $u_t(x)$ï¼Œå®ƒæ˜¯å…³äº $x$ çš„ä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œå³ï¼š$u_t(x) = -\theta x,\quad \theta > 0$ï¼Œé‚£ä¹ˆå‡½æ•°ï¼š$\psi_t(x_0) = \exp(-\theta t)\, x_0 \tag{3}$ å®šä¹‰äº†ä¸€ä¸ªæµï¼ˆflowï¼‰$\psi$ï¼Œå®ƒæ»¡è¶³æˆ‘ä»¬è¦æ±‚çš„å¾®åˆ†æ–¹ç¨‹ï¼ˆODEï¼‰ã€‚

    ç»“æœéªŒè¯ï¼š

    $$
    \begin{align*}
    \psi_0(x_0) &= x_0 \\
    \frac{d}{dt} \psi_t(x_0)  = \frac{d}{dt} \left( \exp(-\theta t)\, x_0 \right)  = &-\theta \exp(-\theta t)\, x_0  = -\theta \psi_t(x_0) = u_t(\psi_t(x_0))
    \end{align*}
    $$



### å¦‚ä½•æ¨¡æ‹Ÿä¸€ä¸ª ODEï¼Ÿ

åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥è®¡ç®—å¾—åˆ° $\psi_t$ï¼Œä½†æœ‰ä¸€äº›æ•°å€¼è®¡ç®—çš„æ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿‘ä¼¼è®¡ç®—å®ƒï¼Œä¾‹å¦‚æ¬§æ‹‰æ–¹æ³• (Euler method)ï¼Œæˆ‘ä»¬åˆå§‹åŒ– $X_0=x_0$ å¹¶åº”ç”¨ä»¥ä¸‹æ–¹ç¨‹ï¼š


$$
X_{t+h}=X_t+hu_t(X_t)\quad(t=0,h,2h,3h,\ldots,1-h)
$$


å…¶ä¸­ï¼Œæ­¥é•¿ $h=n^{-1}\gt0$ æ˜¯ä¸€ä¸ªè¶…å‚æ•°ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ ODE æ¥æ„å»ºä¸€ä¸ªç”Ÿæˆå¼æ¨¡å‹äº†ã€‚åœ¨ç”Ÿæˆå¼æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å®ç°ä»ç®€å•åˆ†å¸ƒ $p_{init}$ åˆ°å¤æ‚åˆ†å¸ƒ $p_{data}$ çš„è½¬æ¢ï¼Œè¿™ç§è½¬æ¢å¾ˆè‡ªç„¶å¯ä»¥è”æƒ³åˆ°ä½¿ç”¨ ODE æ¥è§£å†³ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹çš„ ODE æ¥æè¿°**æµæ¨¡å‹**ï¼š


$$
\begin{align*}
X_0 &\sim p_{\text{init}} && \blacktriangleright \text{ random initialization} \\
\frac{d}{dt}X_t &= u_t^{\theta}(X_t) && \blacktriangleright \text{ ODE}
\end{align*}
$$


å…¶ä¸­ï¼Œ$u_t^\theta$ æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œ$\theta$ æ˜¯ç½‘ç»œå‚æ•°ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æŠŠå®ƒç†è§£æˆä¸€ä¸ªä» $\mathbb{R}^d\times[0,1]\rightarrow\mathbb{R}^d$  çš„è¿ç»­å‡½æ•°å³å¯ã€‚æˆ‘ä»¬çš„**ç›®æ ‡**æ˜¯åœ¨è½¨è¿¹çš„ç»ˆç‚¹ (å³ $X_1$) ç”ŸæˆæœŸå¾…çš„åˆ†å¸ƒ $p_{data}$ï¼Œç›¸å½“äºï¼š


$$
X_1 \sim p_{\text{data}} \iff \psi_1^{\theta}(X_0) \sim p_{\text{data}}
$$


å°½ç®¡æˆ‘ä»¬æŠŠè¿™ä¸ªæ¨¡å‹ç§°ä¸º flow modelï¼Œä½†æ˜¯**ç¥ç»ç½‘ç»œå‚æ•°åŒ–çš„å†…å®¹æ˜¯å‘é‡åœºï¼Œè€Œä¸æ˜¯æµ**ã€‚å¦‚æœæˆ‘ä»¬è¦è®¡ç®—æµï¼Œä»ç„¶éœ€è¦æ¨¡æ‹Ÿè¿™ä¸ª ODE æ‰èƒ½å¾—åˆ°æ•´ä¸ª flowã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬ç»™å‡ºä» flow model è¿›è¡Œé‡‡æ ·çš„ç®—æ³•ï¼š

![flow-algorithm](img/image-20250722202357578.webp)



## æ‰©æ•£æ¨¡å‹ Diffusion Models

SDE (stochastic differential equations) æ˜¯ ODE çš„æ¨å¹¿ï¼Œåœ¨ ODE çš„åŸºç¡€ä¸ŠåŠ å…¥äº†éšæœº (stochastic) è½¨è¿¹ã€‚ä¸€æ¡éšæœºè½¨è¿¹é€šå¸¸è¢«ç§°ä¸ºä¸€ä¸ª**éšæœºè¿‡ç¨‹**ï¼š


$$
\begin{align*}
&X_t \text{ is a random variable for every } 0 \le t \le 1 \\
&X : [0, 1] \to \mathbb{R}^d, \quad t \mapsto X_t \text{ is a random trajectory for every draw of } X
\end{align*}
$$


å½“æˆ‘ä»¬æ‰§è¡ŒåŒä¸€ä¸ªéšæœºè¿‡ç¨‹ä¸¤æ¬¡ï¼Œå¯èƒ½å¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœï¼Œå› ä¸ºæ¯ä¸€æ¬¡çš„å€¼éƒ½æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚



### å¸ƒæœ—è¿åŠ¨

SDEï¼ˆéšæœºå¾®åˆ†æ–¹ç¨‹ï¼‰æ˜¯é€šè¿‡å¸ƒæœ—è¿åŠ¨æ„å»ºçš„â€”â€”è¿™æ˜¯ä¸€ä¸ªæºäºå¯¹ç‰©ç†æ‰©æ•£è¿‡ç¨‹çš„ç ”ç©¶è€Œäº§ç”Ÿçš„åŸºç¡€éšæœºè¿‡ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥å°†å¸ƒæœ—è¿åŠ¨çœ‹ä½œæ˜¯ä¸€ä¸ªè¿ç»­çš„éšæœºæ¸¸èµ°ã€‚

ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥å®šä¹‰å®ƒï¼šä¸€ä¸ªå¸ƒæœ—è¿åŠ¨ $W = (W_t)_{0 \le t \le 1}$ æ˜¯ä¸€ä¸ªéšæœºè¿‡ç¨‹ï¼Œå®ƒæ»¡è¶³ $W_0 = 0$ï¼Œå…¶è½¨è¿¹ $t \mapsto W_t$ æ˜¯è¿ç»­çš„ï¼Œå¹¶ä¸”æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š

1. **æ­£æ€å¢é‡**ï¼šå¯¹äºæ‰€æœ‰ $0 \le s < t$ï¼Œæœ‰ $W_t - W_s \sim \mathcal{N}(0, (t-s)I_d)$ï¼Œå³ï¼Œå¢é‡æœä»é«˜æ–¯åˆ†å¸ƒï¼Œå…¶æ–¹å·®éšæ—¶é—´çº¿æ€§å¢åŠ ï¼ˆ$I_d$ æ˜¯å•ä½çŸ©é˜µï¼‰ã€‚
2. **ç‹¬ç«‹å¢é‡**ï¼šå¯¹äºä»»ä½• $0 \le t_0 < t_1 < \dots < t_n = 1$ï¼Œå¢é‡ $W_{t_1} - W_{t_0}, \dots, W_{t_n} - W_{t_{n-1}}$ æ˜¯ç›¸äº’ç‹¬ç«‹çš„éšæœºå˜é‡ã€‚

å¸ƒæœ—è¿åŠ¨ä¹Ÿç§°ä¸º**ç»´çº³è¿‡ç¨‹**ï¼ˆWiener processï¼‰ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ç”¨å­—æ¯â€œWâ€æ¥è¡¨ç¤ºå®ƒã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®æ­¥é•¿ $h > 0$ï¼Œä»¤ $W_0 = 0$ å¹¶é€šè¿‡ä»¥ä¸‹å…¬å¼æ›´æ–°ï¼Œä»è€Œè½»æ¾åœ°è¿‘ä¼¼æ¨¡æ‹Ÿä¸€ä¸ªå¸ƒæœ—è¿åŠ¨ï¼š


$$
W_{t+h} = W_t + \sqrt{h}\epsilon_t, \quad \epsilon_t \sim \mathcal{N}(0, I_d) \quad (t = 0, h, 2h, \dots, 1-h)
$$


### ä» ODE åˆ° SDE

éšæœºå¾®åˆ†æ–¹ç¨‹ï¼ˆSDEï¼‰çš„æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆODEï¼‰çš„ç¡®å®šæ€§åŸºç¡€ä¸Šï¼Œé€šè¿‡åŠ å…¥ä¸€ä¸ªç”±å¸ƒæœ—è¿åŠ¨é©±åŠ¨çš„éšæœºåŠ¨æ€æ¥è¿›è¡Œæ‰©å±•ã€‚ç”±äºä¸€åˆ‡éƒ½æ˜¯éšæœºçš„ï¼Œæˆ‘ä»¬ä¾¿æ— æ³•å†è¿›è¡Œæ±‚å¯¼ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ç§**ä¸ä½¿ç”¨å¯¼æ•°çš„ç­‰ä»·è¡¨è¿°å½¢å¼**ã€‚

æˆ‘ä»¬é¦–å…ˆå¯¹ä¸Šé¢æåˆ°çš„ ODE æ–¹ç¨‹è¿›è¡Œç­‰ä»·æ”¹å†™ï¼š


$$
\begin{align*}
\frac{d}{dt}X_t &= u_t(X_t) &&\blacktriangleright \text{ expression via derivatives} \\[1.5em]
\stackrel{(i)}{\iff}  \frac{1}{h}(X_{t+h} - X_t) &= u_t(X_t) + R_t(h) \\[1.5em]
\qquad \implies X_{t+h} &= X_t + h u_t(X_t) + h R_t(h) &&\blacktriangleright \text{ expression via infinitesimal updates}
\end{align*}
$$


å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç§æ–°çš„è§†è§’æ¥ç†è§£ ODE å’Œ SDE è§„çº¦ä¸‹çš„è½¨è¿¹ï¼šODE ä¸‹çš„è½¨è¿¹å°±æ˜¯åœ¨æ¯ä¸ªæ—¶é—´æˆ³å‘ $u_t(X_t)$ æ–¹å‘èµ°ä¸€å°æ­¥ï¼›SDE ä¸‹çš„è½¨è¿¹å°±æ˜¯**åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå†åŠ ä¸Šå¸ƒæœ—è¿åŠ¨çš„è´¡çŒ®**ï¼š


$$
X_{t+h} = X_t + \underbrace{h u_t(X_t)}_{\text{deterministic}} + \underbrace{\sigma_t (W_{t+h} - W_t)}_{\text{stochastic}} + \underbrace{h R_t(h)}_{\text{error term}}
$$


å…¶ä¸­ï¼Œ$\sigma_t\geq0$ æè¿°äº† diffusion coefficientï¼Œ$R_t(h)$ æè¿°äº†éšæœºè¯¯å·®ã€‚æ›´å¸¸è§åœ°ï¼Œæˆ‘ä»¬ç»™å‡ºå¦‚ä¸‹å½¢å¼åŒ–æè¿°ï¼š


$$
\begin{align*}
    dX_t &= u_t(X_t)dt + \sigma_t dW_t && \blacktriangleright \text{ SDE} \\
    X_0 &= x_0 && \blacktriangleright \text{ initial condition}
\end{align*}
$$


### å¦‚ä½•æ¨¡æ‹Ÿä¸€ä¸ª SDEï¼Ÿ

å’Œ ODE ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ç›¸åº”çš„æ•°å€¼æ–¹æ³•æ¥æ¨¡æ‹Ÿ SDEã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ„Ÿæ€§åœ°æ¥ç†è§£ Euler-Maruyama methodï¼Œå®ƒå¯ä»¥ç”¨å…¬å¼æ¥æè¿°ï¼Œå…¶ä¸­ $X_0=x_0$ï¼š


$$
X_{t+h} = X_t + h u_t(X_t) + \sqrt{h}\sigma_t \epsilon_t, \quad \epsilon_t \sim \mathcal{N}(0, I_d)
$$


å’Œ Euler æ–¹æ³•ç›¸æ¯”ï¼Œæˆ‘ä»¬å‘ç°å®ƒåªæ˜¯**å¤šåŠ äº†ä¸€ç‚¹é«˜æ–¯å™ªå£°**ã€‚

æ¥ä¸‹æ¥ï¼ŒåŸºäº SDE çš„ç”Ÿæˆå¼æ¨¡å‹å°±æ›´å®¹æ˜“å¾—åˆ°äº†ï¼š

![image-20250722210148219](img/image-20250722210148219.webp)

## æ€»ç»“ä¸€ä¸‹

åœ¨æ¥ä¸‹æ¥çš„æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå‚æ•°ä¸º $\theta$ çš„ç¥ç»ç½‘ç»œæ¥æè¿°**æ‰©æ•£ç”Ÿæˆæ¨¡å‹** (diffusion model)ï¼Œå®ƒå‚æ•°åŒ–äº† vector field å’Œ diffusion coefficient $\sigma_t$ï¼š


$$
\textbf{Neural network:} \quad u^{\theta}: \mathbb{R}^d \times [0, 1] \to \mathbb{R}^d, \; (x, t) \mapsto u_t^{\theta}(x) \text{ with parameters } \theta \\
\textbf{Fixed:} \quad \sigma_t: [0, 1] \to [0, \infty), \; t \mapsto \sigma_t
$$


è€Œä»æˆ‘ä»¬çš„ SDE æ¨¡å‹ä¸­é‡‡æ ·å¾—åˆ°ç”Ÿæˆå¯¹è±¡çš„æ–¹æ³•å¦‚ä¸‹ï¼š


$$
\begin{align*}
    \textbf{Initialization:} \quad & X_0 \sim p_{\text{init}} &&\blacktriangleright \text{ Initialize with simple distribution, e.g. a Gaussian} \\
    \textbf{Simulation:} \quad & dX_t = u_t^{\theta}(X_t)dt + \sigma_t dW_t &&\blacktriangleright \text{ Simulate SDE from 0 to 1} \\
    \textbf{Goal:} \quad & X_1 \sim p_{\text{data}} &&\blacktriangleright \text{ Goal is to make } X_1 \text{ have distribution } p_{\text{data}}
\end{align*}
$$
